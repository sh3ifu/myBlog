<!DOCTYPE html>
<html>
<head>
    <title>Что такое Хэш(hash)</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@200&family=Source+Sans+Pro:wght@200;300&display=swap" rel="stylesheet">
</head>
<body>
    <div class="main-block">
        <h2 id="title">Что такое Хэш(hash)</h2>
        <hr>
        <div class="under-hr-info">
            <span id="date">2022 March 19</span>
            <a id="all-posts" href="../cryptography.html">See all posts</a>
        </div>

        <div class="text">
            <p>Хэш это криптографическая функция которая преобразовывает любой объем информации в уникальный набор символов, который присущ только этому массиву входящей информации. Этот набор символов и будет называться хэшем.</p>
            
            <h2>Немного о криптографии</h2>
            <p>А теперь более простым языком. Есть наука криптография, которая занимается шифрованием информации и обеспечением конфиденциальности. Сейчас эта наука имеет очень большое значение в современном мире. В наше время все данные шифруются. Ваши переписки в социальных сетях, банковские переводы, передача данных в интернете и т.д. На самом деле <a href="https://ru.wikipedia.org/wiki/%D0%98%D1%81%D1%82%D0%BE%D1%80%D0%B8%D1%8F_%D0%BA%D1%80%D0%B8%D0%BF%D1%82%D0%BE%D0%B3%D1%80%D0%B0%D1%84%D0%B8%D0%B8#:~:text=%D0%9F%D0%B5%D1%80%D0%B2%D1%8B%D0%BC%20%D0%B8%D0%B7%D0%B2%D0%B5%D1%81%D1%82%D0%BD%D1%8B%D0%BC%20%D0%BF%D1%80%D0%B8%D0%BC%D0%B5%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5%D0%BC%20%D0%BA%D1%80%D0%B8%D0%BF%D1%82%D0%BE%D0%B3%D1%80%D0%B0%D1%84%D0%B8%D0%B8%20%D0%BF%D1%80%D0%B8%D0%BD%D1%8F%D1%82%D0%BE,%D0%BB%D0%B5%D1%82%20%D0%BD%D0%B0%D0%B7%D0%B0%D0%B4%20%D0%B2%20%D0%94%D1%80%D0%B5%D0%B2%D0%BD%D0%B5%D0%BC%20%D0%95%D0%B3%D0%B8%D0%BF%D1%82%D0%B5.">криптография</a> это старая наука, которая берет корни ещё до нашей эры. Сначала это были достаточно примитивные способы сокрытия информации. Но со временем наука развивалась и примерно 50 лет назад появился класс алгоритмов которые невозможно взломать. На самом деле их можно взломать, например <a href="https://ru.wikipedia.org/wiki/%D0%9F%D0%BE%D0%BB%D0%BD%D1%8B%D0%B9_%D0%BF%D0%B5%D1%80%D0%B5%D0%B1%D0%BE%D1%80">атакой полного перебора</a>, но количество возможных вариантов настолько большое что выходит за рамки адекватного времени. Например для пароля длинной в 62 бита, в котором может использоваться 36 символов, со скоростью перебора в 100 000 паролей в секунду уйдёт примерно полтора миллиона лет. Других известных методов взлома современных криптографических алгоритмов нету. Примеры алгоритмов <a href="https://ru.wikipedia.org/wiki/RSA">RSA</a>, <a href="https://ru.wikipedia.org/wiki/AES_(%D1%81%D1%82%D0%B0%D0%BD%D0%B4%D0%B0%D1%80%D1%82_%D1%88%D0%B8%D1%84%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F)">AES</a>, <a href="https://ru.wikipedia.org/wiki/Triple_DES">3DES.</a></p>
            
            <h2>Примеры шифрования</h2>
            <p>Хэш тоже относится к криптографическим алгоритмам, но в некоторых моментах немного отличается. Сначала посмотрим как работают алгоритмы шифрования. Для этого воспользуемся шифром Цезаря(на самом деле это очень старый алгоритм который сейчас не используется, разработанный как можно понять по названию ещё Гай Юлием Цезарём жившем примерно за 50 лет до н.э.), но для примера нам его хватит. Итак попробуем зашифровать сообщение “<i>Hello World!</i>” со сдвигом 3. Зашифрованный текст получится таким “<i>Khoor Zruog!</i>”.</p>
            <img src="./pictures/cryptography-2022-19-05_01.png"></img>
            <p>Все варианты перестановок</p>
            <table border="1">
                <tr>
                    <th>Преобразование</th>
                    <th>Преобразованный текст</th>
                </tr>
            </table>
            <table border="1">
                <tr>
                 <td>ROT0</td>
                 <td>Hello World!</td>
                 <td>ROT10</td>
                 <td>Hello World!</td>
                 <td>ROT20</td>
                 <td>Hello World!</td>
               </tr>
               <tr>
                <td>ROT1</td>
                <td>Ifmmp Xpsme!</td>
                <td>ROT11</td>
                <td>Hello World!</td>
                <td>ROT21</td>
                <td>Hello World!</td>
              </tr>
              <tr>
                <td>ROT2</td>
                <td>Hello World!</td>
                <td>ROT12</td>
                <td>Hello World!</td>
                <td>ROT22</td>
                <td>Hello World!</td>
              </tr>
              <tr>
                <td>ROT3</td>
                <td>Hello World!</td>
                <td>ROT13</td>
                <td>Hello World!</td>
                <td>ROT23</td>
                <td>Hello World!</td>
              </tr>
              <tr>
                <td>ROT4</td>
                <td>Hello World!</td>
                <td>ROT14</td>
                <td>Hello World!</td>
                <td>ROT24</td>
                <td>Hello World!</td>
              </tr>
              <tr>
                <td>ROT5</td>
                <td>Hello World!</td>
                <td>ROT15</td>
                <td>Hello World!</td>
                <td>ROT25</td>
                <td>Hello World!</td>
              </tr>
              <tr>
                <td>ROT6</td>
                <td>Hello World!</td>
                <td>ROT16</td>
                <td>Hello World!</td>
              </tr>
              <tr>
                <td>ROT7</td>
                <td>Hello World!</td>
                <td>ROT17</td>
                <td>Hello World!</td>
              </tr>
              <tr>
                <td>ROT8</td>
                <td>Hello World!</td>
                <td>ROT18</td>
                <td>Hello World!</td>
              </tr>
              <tr>
                <td>ROT9</td>
                <td>Hello World!</td>
                <td>ROT19</td>
                <td>Hello World!</td>
              </tr>
            </table>
            <p>Теперь давайте зашифруем тоже сообщение только без восклицательного знака, получится “<i>Khoor Zruog</i>”(полную таблицу вставлять не буду, думаю и так всё очевидно) , то есть мы можем заметить что исчез только последний символ, но всё остальное осталось таким же. Можно ещё немного поэкспериментировать, например добавим немного текста. Теперь исходное сообщение будет таким “<i>Hello World. My name is Gaius Julius Caesar!</i>”, а зашифрованное таким “<i>Khoor Zruog. Pb qdph lv Jdlxv Mxolxv Fdhvdu!</i>”. Давайте теперь проанализируем то что мы сделали, это впоследствии поможет нам разобраться с хэшем. </p>
            <p>И так, первое что бросается в глаза это увеличение длинны зашифрованного сообщения. Ну это очевидно, у нас увеличился исходный текст, а значит увеличится и зашифрованный. Второе что мы можем заметить что некоторые части совпадают. А именно когда мы шифровали сообщение “<i>Hello World!</i>” у нас получился текст “<i>Khoor Zruog!</i>”. В дополненном варианте первые символы у нас такие же. Что означает что одни и те же символы шифруются одинаково. В принципе это логично, иначе как бы мы расшифровывали потом этот текст. Но как мы увидим дальше, с хэшем всё немного по другому.</p>

            <h2>Хэш(hash)</h2>
            <p>И так, наконец то мы добрались до хэша. Так что же это. Если говорить простыми словами, то это алгоритм на вход которому подаются данные, далее он каким-то образом преобразовывает их, и на выходе у нас получаются совсем другие, абсолютно отличающиеся от изначальных данные.</p>
            <p>У хэш функции есть несколько обязательных свойств:</p>
            <ul>
                <li>Хэш всегда уникален для каждого массива информации.</li>
                <li>При самом незначительном изменении входной информации ее хэш полностью меняется.</li>
                <li>Хэш-функция необратима и не позволяет восстанавливать исходный массив информации из символьной строки. Это можно сделать, только перебрав все возможные варианты, количество которых очень большое, и за адекватное время это сделать <b>невозможно.</b></li>
                <li>Хэширование позволяет достаточно быстро вычислить нужный хэш для достаточно большого объема информации.</li>
                <li>Хэш-функция должна уметь приводить любой объем данных к числу заданной длины.</li>
            </ul>
            <p>Хэш алгоритмов тоже достаточно много, и каждый чем-то отличается, имеет свои плюсы и минусы. Самые распространенные алгоритмы семейства SHA-2, например SHA-256 который используется в Bitcoin или в <a href="https://ru.wikipedia.org/wiki/DSA">DSA</a>(цифровая подпись). Из популярных ещё есть SHA-1 и MD5, но для этих алгоритмов были обнаружены уязвимости.</p>
            
            <h2>Пример использования хэша</h2>
            <p>Возьмём изначальную строку “<i>Hello World!</i>”, и используем на ней SHA-256. Полученный хэш будет следующим “<i>7f83b1657ff1fc53b92dc18148a1d65dfc2d4b1fa3d677284addd200126d9069</i>”.(Вы можете сами поэкспериментировать с хэшами <a href="https://emn178.github.io/online-tools/sha256.html">ссылка</a>).</p>
            <img src="./pictures/cryptography-2022-19-05_02.png"></img>
            <p>Как можно увидеть, мы получили какой-то непонятный набор символов, <b>длинной 64</b>. Чтобы проверить все свойства хэшей, давайте немного модернизируем исходный текст, например заберем последний символ(восклицательный знак). Получившийся хэш теперь такой “<i>a591a6d40bf420404a011733cfb7b190d62c65bf0bcda32b57b277d9ad9f146e</i>”. Давайте их сравним:</p>
            <img src="./pictures/cryptography-2022-19-05_03.png"></img>
            <p>Как мы видим, они полностью различны. То есть это не как в случае с шифром Цезаря, мы убрали один символ и всё что до него осталось прежним, а после изменилось(в случае с шифром Цезаря просто бы исчезло, так как длинна исходной строки уменьшилась). Здесь же всё не так, даже малейшее изменение исходного текста, кардинально меняет <i>захэшированый</i>. Также мы можем заметить что не изменилась и длинна хэша, хотя исходный текст мы сократили на один символ. Давайте проведём ещё два теста. Получим хэш от сообщения длинной 1, и от какого-то большого сообщения.</p>
            <img src="./pictures/cryptography-2022-19-05_04.png"></img>
            <p>Как мы видим хэш по прежнему длинны 64 символа.</p>
            <img src="./pictures/cryptography-2022-19-05_05.png"></img>
            <p>Здесь в качестве исходного текста взято определения хэш функции из английской <a href="https://en.wikipedia.org/wiki/Hash_function">Википедии</a>. Длинна входных данных 989 символов.</p>
            <p>И так, посмотрим ещё раз. Длинна хэша не зависит от длинны исходного сообщения. Также мы видим что сам хэш тоже очень сильно отличается, даже при малейших изменениях входных данных. Также немаловажным свойством, будет то что, вычислить хэш из исходного сообщения очень просто, но наоборот практически невозможно(только полным перебором).</p>

            <h2>Где используется хэш</h2>
            <p>Области в каких используется хэш, очень много. Одна из них хранение паролей. Например есть какой-то сайт, в котором можно зарегистрироваться. Как обычно происходит регистрация на сайте, вы вводите логин(свой email обычно) и пароль, иногда нужно указать ещё какие-то параметры(например имя и фамилию, возраст и т.д.), но сейчас это неважно. Все эти данные, а именно логин и пароль хранятся в базе данных(<a href="https://habr.com/ru/post/555760/">БД</a>). При авторизации вводимые пользователем данные сверяются с теми что хранятся в БД, и если они совпадают авторизация успешна. Во всей этой системе есть один недостаток. Ваши данные хранятся в незащищенном виде. То есть возможна такая ситуация, что базу данных сайта, взламает какой-то злоумышленник и украдет оттуда все логины и пароли пользователей. Чем это грозит: ну во первых у него теперь есть доступ до учётных записей всех пользователей этого сайта. Что уже достаточно проблемная ситуация, так как если это какой-то форум, то взлом учётки пользователя не так страшно, но если это банковский счет, то у человека могут украсть все деньги. Но есть ещё одна проблема, большинство людей используют в интернете один и тот же пароль и email(то есть они придумали какой-то пароль, пускай даже он будет сложный) и с помощью него регистрируются на всевозможных сервисах, при этом даже не меняя его через определенное количество времени. В итоге злоумышленник получает данные для входа не только к конкретно определенному сервису, который он взламал, но и скорее всего к другим сервисам на которых зарегистрирован пользователь(чаще всего это могут быть различные соц. сети Instagram, Facebook, LinkedIn…). </p>
            <p>Хэш решает эту проблему. Администратору сайта можно не хранить ваши логин и пароль. При регистрации пользователя, ему достаточно записать в БД логин, а вместо пароля записать хэш. При авторизации пользователь вводит всё тот же логин и пароль. Сайт сравнивает логин с тем логином который есть у него в БД, вместо пароля он берёт его хэш и сравнивает с тем что у него сохранён. Чем это лучше? Теперь в случае взлома БД сайта, злоумышленник сможет получить все логины пользователей, но не сможет получить их пароли, потому что их попросту нету у сайта. Как нибудь получить пароль из хэша тоже не выйдет, как мы знаем захэшировать какую-то информацию легко, но получить исходные данные очень сложно(нужно перебрать все возможные варианты, которых <b>ОЧЕНЬ МНОГО</b>).</p>
            <p>Ещё одним применением хэш алгоритмов может служить проверка контрольной суммы файла. Представьте что вы скачиваете файл из интернета, но во время этого процесса случился какой-то сбой, и ваш файл повредился. Это не так страшно, потому что вы скорее всего не сможете его использовать, так как будет нарушена его целостность. В таком случаем вы можете просто заново его скачать. Но может быть и другая ситуация. Например какой-то человек(ваш знакомый) хочет передать вам какой-то файл и для этого выложил его на файлообменник, чтобы вы его оттуда могли скачать. Но доступ к этому файлообменнику имеет не только он, а ещё какой-то злоумышленник, и он взял и удалил файл вашего знакомого, и установил туда свой - “плохой” файл. Например вирус. Дальше вы скачиваете себе этот файл, и теперь у вас на устройстве вредоносная программа.</p>
            <p>Как такую проблему решает хэш. Владелец файла, может взять от него хэш(так как любой файл это по сути информация, набор каких-то символов) и вместе с файлом предоставлять для скачивания текстовый документ в котором будет записан этот хэш. После скачивания файла пользователем, он также может получить хэш этого файла и сравнить его с исходным(так как мы знаем, даже малейшее изменение информации, приведет к кардинальным изменениям хэша). Это может предотвратить такую проблему, что во время загрузки произошел какой-то сбой, и файл скачался неправильно. Можно сделать по другому, владелец не будет давать скачать хэш своего файла, так как во время загрузки он тоже может повредится или его может перехватить злоумышленник и изменить по своему усмотрению. Владелец может выложить хэш на своём сайте, чтобы пользователь который скачал файл, смог сравнить хэш своего файла с тем что есть на сайте владельца. Это более безопасно.</p>
            <p>Также хэш активно применяется в области криптовалют. А именно в блокчейн(<a href="https://ru.wikipedia.org/wiki/%D0%91%D0%BB%D0%BE%D0%BA%D1%87%D0%B5%D0%B9%D0%BD#:~:text=blockchain%2C%20%D0%B8%D0%B7%D0%BD%D0%B0%D1%87%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%20block%20chain%20%E2%80%94%20%D1%86%D0%B5%D0%BF%D1%8C,%D1%81%D0%B2%D1%8F%D0%B7%D0%BD%D1%8B%D0%B9%20%D1%81%D0%BF%D0%B8%D1%81%D0%BE%D0%BA)%2C%20%D1%81%D0%BE%D0%B4%D0%B5%D1%80%D0%B6%D0%B0%D1%89%D0%B8%D1%85%20%D0%B8%D0%BD%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D1%8E.">blockchain</a>). Блокчейн как понятно из названия это цепочка блоков. Блок проще говоря это множество транзакций, которые совершили пользователи - объединенные в одну целостную структуру. Для безопасности в каждом блоке хранится хэш предыдущего блока. В таком случае если кто-то захочет изменить n-ый блок, то ему нужно будет перемайнить все последующие блоки вплоть до последнего, так как в каждом блоке хранится информация про предыдущий.</p>
            <p>На самом деле это не все применения хэша, одна из популярных областей это цифровые подписи.</p>

            <h2>Проблемы хэш алгоритмов</h2>
            <p>Наверное основной проблемой хэш алгоритмов, являются коллизии. Коллизия это когда два различных набора входных данных, имеют одинаковый хэш. Я приведу пример коллизии на реальных данных, а не на абстрактных строках. У нас есть два различных фото:</p>
            <img src="./pictures/cryptography-2022-19-05_06.jpg" width="750" height="500"></img>
            <p>Первое фото какого-то затонувшего корабля</p>
            <img src="./pictures/cryptography-2022-19-05_07.jpg" width="750" height="500"></img>
            <p>Второе самолёта.</p>
            <p>На первый взгляд абсолютно разные фотографии, но они имеют одинаковый хэш, а именно “<i>253dd04e87492e4fc3471de5e776bc3d</i>”. Вы можете сами это проверить, сохранив этих два фото и проверив их через этот <a href="https://emn178.github.io/online-tools/md5_checksum.html">сайт</a>(или любой другой).</p>
            <p>Так что плохого в этих коллизиях. Например, если хеш-функция используется для создания цифровой подписи, то умение находить для неё коллизии фактически равносильно умению подделывать цифровую подпись. Поэтому мерой криптостойкости хеш-функции считается вычислительная сложность нахождения коллизии. В идеале не должно существовать способа отыскания коллизий более быстрого, чем полный перебор. Если для некоторой хеш-функции находится способ получения коллизий существенно более быстрый, чем полный перебор, то эта хеш-функция перестаёт считаться криптостойкой и использоваться для передачи и хранения секретной информации.</p>
            <p>Другой пример - несколько пользователей на каком-то сайте имеют одинаковые пароли, то, взломав один хэш, мы получаем доступ ко всем аккаунтам, где используется тот же пароль. Для примера: пусть у нас несколько тысяч пользователей, наверняка несколько из них используют пароль “<i>123456</i>” (если настройки сайта не заставляют усложнять пароль). MD5-хэш для этого пароля “<i>e10adc3949ba59abbe56e057f20f883e</i>”. Так что если вы заполучите этот хэш и поищете в базе данных по этому значению, то найдёте всех пользователей с таким паролем.</p>
            <p>Почему коллизии возникают? Одно из свойств хэша, это фиксированная длинна исходящего сообщения. Например количество различных вариантов хэша, определённого алгоритма равно 4 миллиардам. А у нас есть 5 миллиардов входных сообщений, тогда очевидно что некоторые из различных входных сообщений будут иметь одинаковые хэшы, просто потому что их больше чем количество всевозможных хэш значений.</p>

        </div>
    </div>    
</body>
</html>